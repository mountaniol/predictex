# End-to-End Testing Framework

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Å–∏—Å—Ç–µ–º—ã –æ—Ü–µ–Ω–∫–∏ –±–∏–∑–Ω–µ—Å–∞ Predictex AI.

## üìã –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å–æ–∑–¥–∞–Ω –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏ –≤ AI evaluation —Å–∏—Å—Ç–µ–º–µ, –≥–¥–µ:

- **–í–æ–ø—Ä–æ—Å**: "Why are you selling now?" (SG01)
- **–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: "Declining sales" 
- **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: Score 0-19 (Critical Risk)
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: Score 50 + –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ "restaurant in Charlotte, NC"

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### [`test_sg01_evaluation_bug.py`](test_sg01_evaluation_bug.py)
–û—Å–Ω–æ–≤–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π:
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –±—Ä–∞—É–∑–µ—Ä –∏ –Ω–∞–≤–∏–≥–∏—Ä—É–µ—Ç –∫ http://192.168.1.50:3000
- –ó–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –æ–ø—Ä–æ—Å–Ω–∏–∫–µ
- –í—ã–±–∏—Ä–∞–µ—Ç "Declining sales" –≤ –≤–æ–ø—Ä–æ—Å–µ SG01
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç score –∏ explanation –æ—Ç AI
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –±–∞–≥–∏

### [`run_sg01_test.py`](run_sg01_test.py)
–ü—Ä–æ—Å—Ç–æ–π —Ä–∞–Ω–Ω–µ—Ä –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

### [`web_interface_explorer.py`](web_interface_explorer.py)
–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Playwright**:
   ```bash
   pip install playwright
   playwright install
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**:
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É http://192.168.1.50:3000

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞

```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
python tests/run_sg01_test.py

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
python tests/test_sg01_evaluation_bug.py
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞

–¢–µ—Å—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≤—ã–≤–µ–¥–µ—Ç:

```
üî¨ STARTING SG01 EVALUATION BUG TEST
============================================================
üöÄ Launching browser...
üåê Navigating to http://192.168.1.50:3000...
‚úÖ Application loaded successfully
üìù Filling basic information...
‚è≥ Waiting for SG01 question...
‚úÖ SG01 question is visible
üéØ Selecting 'Declining sales' option...
‚úÖ 'Declining sales' option selected
‚è≥ Waiting for AI evaluation...
üìä Capturing evaluation results...

============================================================
üìã EVALUATION RESULTS ANALYSIS
============================================================
Score: 50
Risk Level: High Risk
Explanation: For a restaurant in Charlotte, NC, having a DSO of 30-45 days is standard and does not present a major risk. Therefore, the score is high.

============================================================
üéØ EXPECTED vs ACTUAL BEHAVIOR
============================================================
Expected Score: 0-19 (Critical Risk)
Actual Score: 50

üö® 3 BUG(S) DETECTED:
  ‚ùå SCORE BUG: Score should be 0-19 for declining sales (critical risk)
  ‚ùå EXPLANATION BUG: AI giving unrelated restaurant explanation
  ‚ùå CONTEXT BUG: AI confusing question context (DSO vs declining sales)

üí° DIAGNOSIS:
  - Web interface works correctly (sends proper data)
  - AI evaluation logic has context confusion
  - Possible prompt contamination or memory leak

============================================================
‚ùå TEST FAILED: Bugs detected in AI evaluation
============================================================
```

## üêõ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∞–≥–∏

### Bug #1: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π score
- **–û–∂–∏–¥–∞–µ—Ç—Å—è**: 0-19 (Critical Risk)
- **–ü–æ–ª—É—á–µ–Ω–æ**: 50 (High Risk)
- **–ü—Ä–∏—á–∏–Ω–∞**: AI –Ω–µ —Å–ª–µ–¥—É–µ—Ç scoring guidance –¥–ª—è "declining sales"

### Bug #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
- **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ declining sales –∫–∞–∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫
- **–ü–æ–ª—É—á–µ–Ω–æ**: "For a restaurant in Charlotte, NC, having a DSO of 30-45 days..."
- **–ü—Ä–∏—á–∏–Ω–∞**: AI –¥–∞–µ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –¥—Ä—É–≥–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

### Bug #3: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø—É—Ç–∞–Ω–∏—Ü–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: AI –ø—É—Ç–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã —Ä–∞–∑–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- **–≠—Ñ—Ñ–µ–∫—Ç**: –î–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –ø—Ä–æ DSO –≤–º–µ—Å—Ç–æ declining sales
- **–ü—Ä–∏—á–∏–Ω–∞**: –í–æ–∑–º–æ–∂–Ω–∞—è –∫–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –∏–ª–∏ —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
- **–ë—Ä–∞—É–∑–µ—Ä**: Chromium (via Playwright)
- **Viewport**: 1280x720
- **–†–µ–∂–∏–º**: Non-headless (–¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞
1. **Browser Automation**: Playwright –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
2. **DOM Navigation**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–µ–π
3. **Result Capture**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ score –∏ explanation –∏–∑ UI
4. **Bug Detection**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ score
if isinstance(score, int) and score >= 20:
    bugs_found.append("SCORE BUG: Score should be 0-19 for declining sales")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ explanation
if 'restaurant' in explanation.lower() and 'charlotte' in explanation.lower():
    bugs_found.append("EXPLANATION BUG: AI giving unrelated restaurant explanation")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
if 'dso' in explanation.lower():
    bugs_found.append("CONTEXT BUG: AI confusing question context")
```

## üìù –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç –±–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–∏
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥—ã –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ `analyze_results()`
4. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üîç –û—Ç–ª–∞–¥–∫–∞

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Ç–µ—Å—Ç–∞–º–∏:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞**: http://192.168.1.50:3000
2. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Playwright**: `playwright --version`
3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ debug —Ä–µ–∂–∏–º–µ**: –∏–∑–º–µ–Ω–∏—Ç–µ `headless=False` –Ω–∞ `headless=True`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã**: –≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ DOM